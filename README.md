# PYRASTR

pyrastr - библиотека Python для взаимодействия с COM-сервером RastrWin3.

Доступные функции позволяют:
- взаимодействовать с таблицами
- взаимодействовать с параметрами режима
- выполнять утяжеление текущего режима
- выполнять расчеты установившегося режима
- выполнять расчет динамики
- и др.

## Установка

Вы можете скачать собранную библиотеку из раздела [Releases](./releases/) или самостоятельно собрать библиотеку из исходного кода.

**Для работы pyrastr требуется актуальная версия Rastrwin3 64-bit.**

В виртуальном окружении Python (venv) должна быть установлена внешняя библиотека **pywin32**.

## Быстрый старт

Ниже представлен пример быстрого старта для работы с библиотекой:

```python
from pyrastr.pyrastr import Rastr # Импортируем основной класс библиотеки

def main(): # Основная функция
    file = "путь//до//файла.расширение" # Указываем путь до файла, который будет принимать RastrWin
    rastr = Rastr() # Инициализируем объект основного класса Rastr
    rastr.load(file, "RG_REPL", rastr.getTemplate(file)) # Загружаем файл по указанному пути
    vetv = rastr.Tables.table("vetv") # Выбираем таблицу, с которой будем работать по имени (можно и по индексу)

    for row_id in vetv.iterRows(): # Вызываем итератор строк в выбранной таблице в соответствии с установленной выборкой (сейчас выборка пуста)
        rastr.toProtocol(f"В строке {row_id} параметр 'r' заменен с {vetv.column('r').getValue(row_id)} на 10!") # Выводим сообщение в протокол если нужно
        vetv.column("r").setValue(row_id, 10) # Выбираем столбец по названию и устанавливаем значение 10 в строке row_id
    rastr.save("путь//до//файла_сохранения.расширение") # Сохраняем файл с изменениями

if __name__ == '__main__':
    main()
```

## Документация

Ознакомиться с документацией можно [здесь](./docs/index.md).
